import openai
import openai
import json

openai.api_key = #key

def extract_resume_data(resume_text):
    response = openai.ChatCompletion.create(
        model="gpt-4-0613",  
        messages=[
            {"role": "system", "content": "You are a helpful assistant that extracts structured data from resumes."},
            {"role": "user", "content": f"Please extract the resume data from the following text: {resume_text}"}
        ],
        functions=[
            {
                "name": "extract_resume_data",
                "description": "Extracts structured resume data from an unstructured resume text.",
                "parameters": {
                    "type": "object",
                    "properties": {
                        "birth_date": {"type": "string", "description": "The birth date of the individual."},
                        "gender": {"type": "string", "description": "The gender of the individual."},
                        "area": {"type": "string", "description": "The area or city of the individual."},
                        "title": {"type": "string", "description": "The job title of the individual."},
                        "specialization": {
                            "type": "array",
                            "items": {
                                "type": "object",
                                "properties": {
                                    "name": {"type": "string", "description": "The specialization name."},
                                    "profarea_name": {"type": "string", "description": "The professional area name."}
                                }
                            }
                        },
                        "salary": {
                            "type": "object",
                            "properties": {
                                "amount": {"type": ["number", "null"], "description": "The salary amount."},
                                "currency": {"type": ["string", "null"], "description": "The salary currency."}
                            }
                        },
                        "education_level": {"type": "string", "description": "The education level of the individual."},
                        "education": {
                            "type": "array",
                            "items": {
                                "type": "object",
                                "properties": {
                                    "year": {"type": "number", "description": "The year of graduation."},
                                    "name": {"type": "string", "description": "The name of the educational institution."},
                                    "organization": {"type": "string", "description": "The department or faculty."}
                                }
                            }
                        },
                        "language": {
                            "type": "array",
                            "items": {
                                "type": "object",
                                "properties": {
                                    "name": {"type": "string", "description": "The language name."},
                                    "level": {"type": "string", "description": "The proficiency level."}
                                }
                            }
                        },
                        "experience": {
                            "type": "array",
                            "items": {
                                "type": "object",
                                "properties": {
                                    "start": {"type": "string", "description": "The start date of the experience."},
                                    "end": {"type": ["string", "null"], "description": "The end date of the experience."},
                                    "position": {"type": "string", "description": "The position held during this experience."},
                                    "description": {"type": "string", "description": "The description of the work performed."}
                                }
                            }
                        },
                        "skills": {"type": "string", "description": "The skills of the individual."}
                    }
                }
            }
        ],
        function_call="auto"  
    )

    extracted_data = json.loads(response['choices'][0]['message']['function_call']['arguments'])
    
    complete_data = {
        "birth_date": extracted_data.get("birth_date", None),
        "gender": extracted_data.get("gender", None),
        "area": extracted_data.get("area", None),
        "title": extracted_data.get("title", None),
        "specialization": extracted_data.get("specialization", []),
        "salary": {
            "amount": extracted_data.get("salary", {}).get("amount", None),
            "currency": extracted_data.get("salary", {}).get("currency", None)
        },
        "education_level": extracted_data.get("education_level", None),
        "education": extracted_data.get("education", []),
        "language": extracted_data.get("language", []),
        "experience": extracted_data.get("experience", []),
        "skills": extracted_data.get("skills", None)
    }

    return complete_data

# Текст резюме
resume_text = """
Валаев Георгий Георгиевич
+7 (925) 3700088, WhatsApp, Telegram n@vaaaev.ru


Эксперт по информационной безопасности

Краткое описание:
В течение долгого времени я успешно руководил комплексными проектами в области информационной безопасности. Мой опыт также включает управление коммерческими проектами, в том числе продажи и поставку программных решений в области информационной безопасности. Я формировал бизнес-стратегии, оптимизировал процессы и работал с вендорами, чтобы достичь планируемых результатов.

Мой опыт включает роль заместителя начальника отдела управления проектами цифровой трансформации, где я успешно завершил несколько проектов в этой области. В Российском Фонде Информации при Минприроды России я организовывал и управлял проектами по созданию Государственных Информационных систем (ГИС) с учетом нормативных актов №
№ 149-ФЗ, 152-ФЗ, ПП РФ № 563, 676, 313 и т.д. Я принимал непосредственное участие в написании и согласовании концепций ГИС "Охота" и ГИС "Природные Территории". Кроме того, я успешно реализовал проект внедрения ведомственной ИС АРМ МЭДО ДСП, включая согласование МуИН в соответствующих структурах, выделение бюджета и развертывание системы. Я также участвовал в создании пакетов проектной и тендерной документаци. Мои навыки руководителя включают в себя разработку и реализацию стратегических планов отдела.

До этого, в рамках ИТ-интегратора, после Value-added дистрибьютора решений информационной безопасности, я занимался продажей решений ИБ. Я работал в роли аккаунт менеджера, продукт-менеджера и руководителя проектов внедрения ИБ. Мои обязанности включали опережающую коммуникацию с заказчиками и интеграторами, оформление бизнес-требований, управление выбором решений, развитие партнерских отношений, продажи и управление проектами внедрения, включая управление проектной командой, участие в во встречах, конференциях и вебинарах.

Я имею опыт в разработке мер безопасности для заказчиков финансового сектора на основе PCI DSS, положений ЦБ РФ 683-П, 684-П, 672-П, 719-П, 747-П, 757-П ГОСТ 5780.* и т.д.

Сейчас я активно прорабатываю тему импортозамещения средств информационной безопасности с помощью продуктов ИБ отечественных производителей или правообладателей.
Краткий опыт работы.
Заместитель начальника отдела управления проектами цифровой трансформации:
успешно завершил несколько проектов в области цифровой трансформации;
руководил внедрением комплексных решений на всех этапах жизненного цикла проектов. 
Менеджер по работе с ключевыми заказчиками:
управление отношениями с ключевыми клиентами; руководство проектами внедрения решений; консультации по продукту, демонстрации и тестирование. Образование:
высшее техническое образование (МАИ факультет Радиоэлектроники);
высшее образование в области информационной безопасности (Образовательный центр Информзащита).
Языки:
Русский (родной); Английский (свободно); Немецкий (технический). Дополнительные навыки:
коммуникативные навыки;
организационные способности; умение работать в команде; аналитическое мышление; управление временем; готовность к командировкам.
Работа с офисными пакетами, системами документооборота.
Python, Bash скрипты, администрирование рабочих мест и серверов Linux

Полный опыт работы:
Российский Фонд Информации Минприроды России. 2022- 2023.
https://rfi.mnr.gov.ru
ИТ-проекты в пользу Министерства Природы Российской Федерации, системная интеграция, автоматизация технологических и бизнес-процессов предприятия, ИТ-консалтинг.

Заместитель начальника отдела управления проектами цифровой трансформации. Обязанности:
Участие в формировании требований к государственной информационной системе (ГИС, ФГИС), включая требования по информационной безопасности;
описание выявленных проблем, решение которых возможно средствами системы, описание требований к системе, включая определение требований к информационной системе защиты информации и допустимых затрат на разработку, ввод в действие и эксплуатацию системы;
создание и согласование концепции ГИС, включая создание и согласование концепции, ТЗ на создание системы с учетом модели угроз безопасности, а также уровней защищенности персональных данных при их обработке в информационных системах персональных данных в зависимости от угроз безопасности этих данных и требований;
управление ее созданием в соответствии с постановлением № 676 и другими НПА; участие в создании нормативно-правового обоснования создания ГИС;
участие в разработке и согласовании проектных документов; участие в организации закупок через ЕИС Госзакупки;
участие в разработке и согласовании рабочей документации, создание, ввод в действие, аттестация по требованиям ИБ.
Результаты работы:
инициирован ряд проектов по созданию федеральных государственных информационных систем в области охраны природы;
успешно выполнен проект по внедрению АРМ МЭДО ДСП. 
Web-Control. Дистрибьютор решений информационной безопасности. 2015-2022.
www.web-control.ru
Информационная безопасность, value added дистрибуция решений ИБ, собственная разработка ПО «PAM Space».

Аккаунт-менеджер/Продукт-менеджер/Руководитель проектов внедрения. Обязанности:
понимание принципов SOC;
организация работ в соответствии с НПА: ГОСТ 57580.**, 187-ФЗ, 152-ФЗ, 683П, 747П и другими;
построение архитектуры ИБ на основе МуиН;
управление продажами комплексных проектов (программные решения по ИБ), включая помощь во встраивании решений ИБ в архитектуру информационной безопасности заказчиков, как правило, банков;
управление коммуникациями с конечными заказчиками и системными интеграторами; участие в проектах в роли продавца, руководителя проекта;
взаимодействие с вендорами, подбор решений, заключение договоров с поставщиками, оптимизация условий сотрудничества в роли менеджера по продукту;
интервьюирование заказчика, экспресс-обследование, аналитика, формализация бизнес- требований, комплексная проработка технических решений, согласование условий, подписание контрактов;
формирование команды проекта. Контроль реализации проекта на всех этапах, обеспечение выполнения функциональных требований, управление изменениями, сроками и качеством;
поддержка и развитие партнеров, кросс-продажи.
Достижения: обеспечил успешную реализацию проектов для ряда крупных заказчиков (финансовые институты).
Публикации:
"Код в доступе: на российских заводах массово игнорируют кибербезопасность" - https://iz.ru/1326483/ivan-chernousov/kod-v-dostupe-na-rossiiskikh-zavodakh-massovo- ignoriruiut-kiberbezopasnost
Видео "Web-Control на канале ITD" - https://www.youtube.com/watch?v=WoxSAWQ-0Og Статья "Информационная безопасность в веб-интерфейсах" - http://cs.groteck.ru/IB_1_2021/20/index.html
Видео "Web-Control на конференции IT Security Meetup
" - https://www.youtube.com/watch?v=wus5WzFBRec&t=6s

Т1 Интеграция. 2009-2015.
Продавец. Обязанности:
лидирование комплексных проектов по продажам решений информационной безопасности, таких как спам-фильтрация, веб-фильтрация, файерволлинг, SIEM, DLP и др., а также решений по оптимизации и управлению инкассациями и потоками наличных денежных средств и мобильному банкингу;
выстраивание процессов взаимодействия с заказчиками и согласование условий сотрудничества;
аналитика, проработка решений под требования заказчика, проведение презентаций; сопровождение клиентов на всех этапах проекта и предоставление постпродажной
поддержки;
обеспечение исполнения функциональных требований заказчика и контроль работы проектной команды; 
обеспечение экономической эффективности операционной деятельности.
Достижения:
реализован проект поставки оборудования Cisco на сумму 3 млн. долларов; карьерный рост: (01.2009 – 05.2012) Менеджер по продуктам.

ООО "Техносфера", "Ritzio", игорный бизнес. 2003- 2009.
Заместитель руководителя отдела внедрения и анализа. Обязанности:
управление проектами внедрения ERP системы в компаниях холдинга в Северо-западном регионе России, странах Балтии, Чехии, Румынии и Германии;
организация процессов технической поддержки игровых аппаратов под брендом "Вулкан"; руководство проектной командой из 10 человек - подбор, обучение, мотивация и развитие
персонала, постановка и распределение задач, контроль результатов;
планирование стратегии развития информационных систем, управление коммуникациями, рисками и сроками;
организация и сопровождение пилотирования, внедрения и тиражирования решений во всей системе холдинга, включая низкоуровневую интеграцию множества конечных систем;
проведение тестирований, управление изменениями, развитие продукта и оценка эффективности результатов;
Достижения: реализовано внедрение https://acresmanufacturing.com/ в промышленную эксплуатацию;
реализовано внедрение системы отчетности как части распределенной системы управления бизнесом (ERP, собственная разработка) в региональных компаниях Румынии и Латвии.
Карьерный рост: заместитель руководителя отдела внедрения и анализа он-лайн систем.

ООО "УНИКУМ-СПМ". 2000-2003.
www.unicum.ru
Продажа и поддержка игровых и вендинговых аппаратов.
Координатор сервисной службы. Обязанности:
организация гарантийного и постгарантийного обслуживания электронной техники с персоналом до 10 человек;
Инженер сервисной службы. Обязанности:
монтаж и настройка электронного оборудования; поддержка заказчиков.
Карьерный рост: инженер - координатор сервисной службы.

ТОО «СВИФТ». Автомобильный бизнес. 1994-2000.
Владение и управление магазином запасных частей для легковых автомобилей Европейского и Японского производства.

СТОА иномарок европейского производства. 1992-1994.
Заведующий складом
Ведение склада, планирование остатка, заказ, логистика запчастей и расходных материалов;

Компания по прокату автомобилей. 1992.
Инженер.
Обязанности:
управление сменой механиков по направлениям WAG, BMW; 
автоэлектроника и автомобильные компьютеры. Диагностика и ремонт.

Научно-исследовательский институт приборостроения им. В.В. Тихомирова. 1984-1992.
www.niip.ru
Ведущий инженер-конструктор РЭА. Обязанности:
участие в разработке системы управления вооружением истребителя-перехватчика; участие в настройке и испытаниях радиолокационного прицельного комплекса.
Карьерный рост: инженер - старший инженер - ведущий инженер.

Высшее образование:
АНО ДПО "Учебный центр "Информзащита", специалист по информационной безопасности; МАИ, факультет радиоэлектроники летательных аппаратов, инженер.

Курсы повышения квалификации — по запросу. Языки — английский, С1.
Права — категория А, В.
"""

def save_json_to_file(data, filename="resume_data.json"):
    with open(filename, "w", encoding="utf-8") as json_file:
        json.dump(data, json_file, ensure_ascii=False, indent=4)
    print(f"Данные успешно сохранены в файл {filename}")
extracted_data = extract_resume_data(resume_text)
save_json_to_file(extracted_data, "extracted_resume_data.json")

print(extracted_data)
